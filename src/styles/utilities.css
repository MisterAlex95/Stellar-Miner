@layer components {
  .next-milestone-wrap {
    margin: -0.5rem 0 0.5rem 0;
  }
  .next-milestone-bar {
    @apply h-1 rounded-full overflow-hidden bg-black/15;
    margin-bottom: 0.35rem;
  }
  .next-milestone-bar-fill {
    @apply h-full rounded-full bg-primary transition-[width] duration-500;
  }
  .next-milestone {
    @apply text-center text-foreground-muted;
    font-size: 0.8rem;
    margin: 0;
  }

  .btn-tooltip-wrap {
    @apply inline-block;
  }
  .btn-tooltip-wrap:has(button:disabled) {
    @apply cursor-not-allowed;
  }

  .empty-state {
    @apply flex flex-col items-center gap-2 py-5 px-4 mb-3 text-center bg-card border border-dashed border-border rounded-md;
  }
  .empty-state[hidden] {
    @apply !hidden;
  }
  .empty-state-icon {
    @apply text-3xl leading-none opacity-[0.85];
  }
  .empty-state-icon:empty {
    @apply hidden;
  }
  .empty-state-text {
    @apply m-0 text-sm text-foreground-muted leading-snug max-w-[280px];
  }
}

@media (prefers-reduced-motion: reduce) {
  .app-tab--has-action,
  .app-tab-bottom--has-action {
    animation: none !important;
  }
  .stat-card--bump,
  .upgrade-card--just-bought,
  .float-coin,
  .float-coin-combo,
  .float-reward,
  .combo-indicator,
  .production-live,
  #app.app--shake {
    animation: none !important;
  }
  .mine-zone {
    animation: none !important;
  }
  .stat-card,
  .upgrade-card,
  .mine-zone,
  .upgrade-btn,
  .float-coin,
  .float-reward {
    transition-duration: 0.01ms !important;
  }
  .combo-indicator--fading {
    animation: none;
    opacity: 0.8;
  }
  .prestige-btn--just-unlocked,
  .upgrade-card--just-affordable {
    animation: none !important;
  }
}

html[data-reduced-motion="true"] .app-tab--has-action,
html[data-reduced-motion="true"] .app-tab-bottom--has-action {
  animation: none !important;
}
html[data-reduced-motion="true"] .stat-card--bump,
html[data-reduced-motion="true"] .upgrade-card--just-bought,
html[data-reduced-motion="true"] .float-coin,
html[data-reduced-motion="true"] .float-coin-combo,
html[data-reduced-motion="true"] .float-reward,
html[data-reduced-motion="true"] .combo-indicator,
html[data-reduced-motion="true"] .production-live,
html[data-reduced-motion="true"] #app.app--shake,
html[data-reduced-motion="true"] .mine-zone,
html[data-reduced-motion="true"] .stat-card,
html[data-reduced-motion="true"] .upgrade-card,
html[data-reduced-motion="true"] .upgrade-btn,
html[data-reduced-motion="true"] .prestige-btn--just-unlocked,
html[data-reduced-motion="true"] .upgrade-card--just-affordable {
  animation: none !important;
}
html[data-reduced-motion="true"] .stat-card,
html[data-reduced-motion="true"] .upgrade-card,
html[data-reduced-motion="true"] .mine-zone,
html[data-reduced-motion="true"] .upgrade-btn,
html[data-reduced-motion="true"] .float-coin,
html[data-reduced-motion="true"] .float-reward {
  transition-duration: 0.01ms !important;
}
html[data-reduced-motion="true"] .combo-indicator--fading {
  animation: none;
  opacity: 0.8;
}

/* Achievement unlock: short celebratory flash (respects reduced motion) */
#app.achievement-unlock-celebration::before {
  content: '';
  position: fixed;
  inset: 0;
  z-index: 9998;
  pointer-events: none;
  background: radial-gradient(ellipse 80% 50% at 50% 50%, rgba(245, 158, 11, 0.35), transparent 60%);
  animation: achievement-flash 0.6s ease-out forwards;
}
@keyframes achievement-flash {
  0% { opacity: 0; }
  25% { opacity: 1; }
  100% { opacity: 0; }
}
html[data-reduced-motion="true"] #app.achievement-unlock-celebration::before,
@media (prefers-reduced-motion: reduce) {
  #app.achievement-unlock-celebration::before {
    animation: none;
    opacity: 0.4;
  }
}
