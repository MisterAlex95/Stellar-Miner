---
description: Stellar Miner project context and conventions for AI
alwaysApply: true
---

# Stellar Miner — Project rules

- **Vibecoded for fun**: This is a hobby idle game. Prefer playful, maintainable code; avoid over-engineering. Scope is flexible.
- **Stack**: TypeScript (ES2022, strict), Vite, Vitest, Playwright. ESLint + Prettier. All code and comments in English.
- **Architecture**: DDD-style layers. **domain/** (entities, value objects, aggregates, events, services) → **application/** (gameState, handlers, catalogs, quests, research, eventBus, strings, etc.) → **presentation/** (views, toasts, canvases) → **infrastructure/** (SaveLoadService). Do not bypass layers (e.g. presentation must not call domain services directly; use application handlers).
- **Key entry points**: Game bootstrap in `src/game.ts`; UI mount in `src/presentation/mount.ts`; handlers in `src/application/handlers.ts`. State in `gameState.ts`; persistence in `SaveLoadService`; i18n via `t(key)` from `strings.ts`.
- **Docs**: See `docs/README.md` for the full index; `docs/architecture/overview.md` for DDD and flows; `docs/features/` for gameplay; `docs/data/` for schemas. Backlog and tasks live in the project kanban (`project/tasks/`). Keep README and docs in sync when adding features.
- **Tests**: Unit tests next to or in `*.test.ts`; E2E in `e2e/`. Run `yarn test`, `yarn test:coverage`, `yarn test:e2e`. Coverage is configured in `vite.config.ts` (provider: v8, reporters: text/html/lcov, thresholds, handlers and presentation excluded).
- **Typecheck**: After making code changes, always run `npm run typecheck` (or `yarn typecheck`) and fix any TypeScript errors before considering the task done.
- **Version & changelog**: One version bump and one changelog entry **per completed task**. When a task is done: bump `version` in `package.json` and add (or update the top) entry in `src/data/changelog.json` with a short line for that task in `changes`. Format: `version`, `date` (e.g. "2026-02"), `changes` (array of short strings). Newest entry first.
